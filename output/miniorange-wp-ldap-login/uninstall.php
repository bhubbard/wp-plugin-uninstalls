<?php

// If uninstall not called from WordPress, then exit.
if ( ! defined( 'WP_UNINSTALL_PLUGIN' ) ) {
	exit;
}

// Delete Options
delete_option('mo_ldap_current_plugin_version');
delete_site_option('mo_ldap_current_plugin_version');
delete_option('mo_ldap_cloud_upgrade_is_error');
delete_site_option('mo_ldap_cloud_upgrade_is_error');
delete_option('mo_ldap_enable_login');
delete_site_option('mo_ldap_enable_login');
delete_option('mo_ldap_authorized_users_only');
delete_site_option('mo_ldap_authorized_users_only');
delete_option('mo_ldap_register_user');
delete_site_option('mo_ldap_register_user');
delete_option('mo_ldap_enable_both_login');
delete_site_option('mo_ldap_enable_both_login');
delete_option('mo_ldap_cloud_public_pages_list');
delete_site_option('mo_ldap_cloud_public_pages_list');
delete_option('mo_ldap_cloud_public_pages_enable');
delete_site_option('mo_ldap_cloud_public_pages_enable');
delete_option('mo_ldap_registration_status');
delete_site_option('mo_ldap_registration_status');
delete_option('mo_ldap_admin_email');
delete_site_option('mo_ldap_admin_email');
delete_option('mo_ldap_new_registration');
delete_site_option('mo_ldap_new_registration');
delete_option('mo_ldap_admin_phone');
delete_site_option('mo_ldap_admin_phone');
delete_option('mo_ldap_verify_customer');
delete_site_option('mo_ldap_verify_customer');
delete_option('mo_ldap_admin_customer_key');
delete_site_option('mo_ldap_admin_customer_key');
delete_option('mo_ldap_admin_api_key');
delete_site_option('mo_ldap_admin_api_key');
delete_option('mo_ldap_customer_token');
delete_site_option('mo_ldap_customer_token');
delete_option('mo_ldap_message');
delete_site_option('mo_ldap_message');
delete_option('mo_ldap_redirect_to');
delete_site_option('mo_ldap_redirect_to');
delete_option('mo_ldap_custom_redirect');
delete_site_option('mo_ldap_custom_redirect');
delete_option('mo_ldap_skip_redirectto_parameter');
delete_site_option('mo_ldap_skip_redirectto_parameter');
delete_option('mo_ldap_server_password');
delete_site_option('mo_ldap_server_password');
delete_option('mo_ldap_transactionId');
delete_site_option('mo_ldap_transactionId');
delete_option('mo_ldap_save_config_success');
delete_site_option('mo_ldap_save_config_success');
delete_option('mo_ldap_license_status');
delete_site_option('mo_ldap_license_status');
delete_option('mo_ldap_cloud_license_info');
delete_site_option('mo_ldap_cloud_license_info');
delete_option('mo_enable_page_link_restriction');
delete_site_option('mo_enable_page_link_restriction');
delete_option('mo_page_link_list');
delete_site_option('mo_page_link_list');
delete_option('mo_page_link_restriction');
delete_site_option('mo_page_link_restriction');
delete_option('mo_ldap_ldap_protocol');
delete_site_option('mo_ldap_ldap_protocol');
delete_option('mo_ldap_ldap_server_address');
delete_site_option('mo_ldap_ldap_server_address');
delete_option('mo_ldap_ldap_port_number');
delete_site_option('mo_ldap_ldap_port_number');
delete_option('mo_ldap_ldaps_port_number');
delete_site_option('mo_ldap_ldaps_port_number');
delete_option('mo_ldap_server_dn');
delete_site_option('mo_ldap_server_dn');
delete_option('mo_ldap_search_base');
delete_site_option('mo_ldap_search_base');
delete_option('mo_ldap_search_filter');
delete_site_option('mo_ldap_search_filter');
delete_option('mo_ldap_cloud_directory_server_value');
delete_site_option('mo_ldap_cloud_directory_server_value');
delete_option('mo_ldap_cloud_filter_check');
delete_site_option('mo_ldap_cloud_filter_check');
delete_option('mo_ldap_username_attributes');
delete_site_option('mo_ldap_username_attributes');
delete_option('mo_ldap_extra_user_attribute');
delete_site_option('mo_ldap_extra_user_attribute');
delete_option('mo_ldap_server_url');
delete_site_option('mo_ldap_server_url');
delete_option('mo_ldap_email_attribute');
delete_site_option('mo_ldap_email_attribute');
delete_option('mo_ldap_phone_attribute');
delete_site_option('mo_ldap_phone_attribute');
delete_option('mo_ldap_fname_attribute');
delete_site_option('mo_ldap_fname_attribute');
delete_option('mo_ldap_lname_attribute');
delete_site_option('mo_ldap_lname_attribute');
delete_option('mo_ldap_nickname_attribute');
delete_site_option('mo_ldap_nickname_attribute');
delete_option('mo_ldap_admin_fname');
delete_site_option('mo_ldap_admin_fname');
delete_option('mo_ldap_admin_lname');
delete_site_option('mo_ldap_admin_lname');
delete_option('mo_ldap_admin_company');
delete_site_option('mo_ldap_admin_company');
delete_option('mo_ldap_login_messages');
delete_site_option('mo_ldap_login_messages');
delete_option('mo_ldap_display_name_attribute');
delete_site_option('mo_ldap_display_name_attribute');
delete_option('mo_ldap_cloud_enable_role_restriction');
delete_site_option('mo_ldap_cloud_enable_role_restriction');
delete_option('mo_ldap_enable_role_mapping');
delete_site_option('mo_ldap_enable_role_mapping');
delete_option('mo_ldap_enable_attribute_mapping');
delete_site_option('mo_ldap_enable_attribute_mapping');
delete_option('mo_ldap_mapping_memberof_attribute');
delete_site_option('mo_ldap_mapping_memberof_attribute');
delete_option('mo_ldap_role_mapping_count');
delete_site_option('mo_ldap_role_mapping_count');
delete_option('mo_ldap_keep_existing_user_roles');
delete_site_option('mo_ldap_keep_existing_user_roles');
delete_option('mo_ldap_mapping_value_default');
delete_site_option('mo_ldap_mapping_value_default');
global $wpdb;
$options = $wpdb->get_col( $wpdb->prepare( "SELECT option_name FROM {$wpdb->options} WHERE option_name LIKE %s", 'mo_ldap_mapping_key_%' ) );
foreach ( $options as $opt ) {
	delete_option( $opt );
	delete_site_option( $opt );
}
global $wpdb;
$options = $wpdb->get_col( $wpdb->prepare( "SELECT option_name FROM {$wpdb->options} WHERE option_name LIKE %s", 'mo_ldap_mapping_value_%' ) );
foreach ( $options as $opt ) {
	delete_option( $opt );
	delete_site_option( $opt );
}
delete_option('mo_ldap_cloud_restricted_login_roles');
delete_site_option('mo_ldap_cloud_restricted_login_roles');
delete_option('mo_ldap_cloud_user_logs_table_exists');
delete_site_option('mo_ldap_cloud_user_logs_table_exists');
delete_option('mo_ldap_cloud_export_pass');
delete_site_option('mo_ldap_cloud_export_pass');
delete_option('mo_ldap_check_ln');
delete_site_option('mo_ldap_check_ln');
delete_option('mo_customer_check_ln');
delete_site_option('mo_customer_check_ln');
delete_option('mo_ldap_free_version');
delete_site_option('mo_ldap_free_version');
delete_option('mo_ldap_admin_use_case');
delete_site_option('mo_ldap_admin_use_case');
delete_option('mo_ldap_local_verify_customer');
delete_site_option('mo_ldap_local_verify_customer');
delete_option('mo_ldap_cloud_disabled_local_login');
delete_site_option('mo_ldap_cloud_disabled_local_login');
delete_option('mo_ldap_cloud_local_user_report_log');
delete_site_option('mo_ldap_cloud_local_user_report_log');
delete_option('mo_ldap_cloud_directory_server_custom_value');
delete_site_option('mo_ldap_cloud_directory_server_custom_value');
delete_option('mo_ldap_cloud_directory_server');
delete_site_option('mo_ldap_cloud_directory_server');
delete_option('mo_ldap_enable_debugger');
delete_site_option('mo_ldap_enable_debugger');
delete_option('mo_ldap_cust');
delete_site_option('mo_ldap_cust');
global $wpdb;
$options = $wpdb->get_col( $wpdb->prepare( "SELECT option_name FROM {$wpdb->options} WHERE option_name LIKE %s", 'mo_ldap_custom_attribute_%' ) );
foreach ( $options as $opt ) {
	delete_option( $opt );
	delete_site_option( $opt );
}
delete_option('mo_ldap_dn_attribute');
delete_site_option('mo_ldap_dn_attribute');
delete_option('mo_ldap_license_flag_cloud');
delete_site_option('mo_ldap_license_flag_cloud');
delete_option('mo_ldap_ldap_login_status_cloud');
delete_site_option('mo_ldap_ldap_login_status_cloud');
delete_option('mo_ldap_test_auth_cloud');
delete_site_option('mo_ldap_test_auth_cloud');
delete_option('mo_ldap_config_status_cloud');
delete_site_option('mo_ldap_config_status_cloud');
delete_option('mo_ldap_activation_time_cloud');
delete_site_option('mo_ldap_activation_time_cloud');
delete_option('mo_ldap_xecurify_migration');
delete_site_option('mo_ldap_xecurify_migration');
delete_option('mo_ldap_default_config');
delete_site_option('mo_ldap_default_config');
delete_option('mo_ldap_cloud_admin_phone');
delete_site_option('mo_ldap_cloud_admin_phone');

// Clear Metadata
global $wpdb;
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", 'mo_ldap_cloud_user_phone' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", 'mo_ldap_cloud_user_phone' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", 'mo_ldap_cloud_user_phone' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", 'mo_ldap_cloud_user_phone' ) );

