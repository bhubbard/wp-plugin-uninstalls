<?php

// If uninstall not called from WordPress, then exit.
if ( ! defined( 'WP_UNINSTALL_PLUGIN' ) ) {
	exit;
}

// Delete Options
delete_option('wpvulnerability-analyze');
delete_site_option('wpvulnerability-analyze');
delete_option('wpvulnerability-config');
delete_site_option('wpvulnerability-config');
delete_option('wpvulnerability-statistics');
delete_site_option('wpvulnerability-statistics');
delete_option('wpvulnerability-core-vulnerable');
delete_site_option('wpvulnerability-core-vulnerable');
delete_option('wpvulnerability-plugins-vulnerable');
delete_site_option('wpvulnerability-plugins-vulnerable');
delete_option('wpvulnerability-themes-vulnerable');
delete_site_option('wpvulnerability-themes-vulnerable');
delete_option('wpvulnerability-php-vulnerable');
delete_site_option('wpvulnerability-php-vulnerable');
delete_option('wpvulnerability-apache-vulnerable');
delete_site_option('wpvulnerability-apache-vulnerable');
delete_option('wpvulnerability-nginx-vulnerable');
delete_site_option('wpvulnerability-nginx-vulnerable');
delete_option('wpvulnerability-mariadb-vulnerable');
delete_site_option('wpvulnerability-mariadb-vulnerable');
delete_option('wpvulnerability-mysql-vulnerable');
delete_site_option('wpvulnerability-mysql-vulnerable');
delete_option('wpvulnerability-imagemagick-vulnerable');
delete_site_option('wpvulnerability-imagemagick-vulnerable');
delete_option('wpvulnerability-curl-vulnerable');
delete_site_option('wpvulnerability-curl-vulnerable');
delete_option('wpvulnerability-memcached-vulnerable');
delete_site_option('wpvulnerability-memcached-vulnerable');
delete_option('wpvulnerability-redis-vulnerable');
delete_site_option('wpvulnerability-redis-vulnerable');
delete_option('wpvulnerability-sqlite-vulnerable');
delete_site_option('wpvulnerability-sqlite-vulnerable');
delete_option('wpvulnerability-core-cache');
delete_site_option('wpvulnerability-core-cache');
delete_option('wpvulnerability-messages');
delete_site_option('wpvulnerability-messages');
delete_option('wpvulnerability-core');
delete_site_option('wpvulnerability-core');
delete_option('wpvulnerability-core-version');
delete_site_option('wpvulnerability-core-version');
global $wpdb;
$options = $wpdb->get_col( $wpdb->prepare( "SELECT option_name FROM {$wpdb->options} WHERE option_name LIKE %s", '%-cache' ) );
foreach ( $options as $opt ) {
	delete_option( $opt );
	delete_site_option( $opt );
}
delete_option('wpvulnerability-logs');
delete_site_option('wpvulnerability-logs');
global $wpdb;
$options = $wpdb->get_col( $wpdb->prepare( "SELECT option_name FROM {$wpdb->options} WHERE option_name LIKE %s", '%-vulnerable' ) );
foreach ( $options as $opt ) {
	delete_option( $opt );
	delete_site_option( $opt );
}
delete_option('wpvulnerability-plugins-signature');
delete_site_option('wpvulnerability-plugins-signature');
delete_option('wpvulnerability-themes-signature');
delete_site_option('wpvulnerability-themes-signature');
delete_option('wpvulnerability-statistics-cache');
delete_site_option('wpvulnerability-statistics-cache');
delete_option('network_name_option');
delete_site_option('network_name_option');
delete_option('wpvulnerability-plugins');
delete_site_option('wpvulnerability-plugins');
delete_option('wpvulnerability-plugins-cache');
delete_site_option('wpvulnerability-plugins-cache');
delete_option('wpvulnerability-plugins-data');
delete_site_option('wpvulnerability-plugins-data');
delete_option('wpvulnerability-plugins-cache-data');
delete_site_option('wpvulnerability-plugins-cache-data');
delete_option('wpvulnerability_settings');
delete_site_option('wpvulnerability_settings');
delete_option('wpvulnerability-data');
delete_site_option('wpvulnerability-data');
global $wpdb;
$options = $wpdb->get_col( $wpdb->prepare( "SELECT option_name FROM {$wpdb->options} WHERE option_name LIKE %s", 'wpvulnerability-%' ) );
foreach ( $options as $opt ) {
	delete_option( $opt );
	delete_site_option( $opt );
}
delete_option('wpvulnerability-themes');
delete_site_option('wpvulnerability-themes');
delete_option('wpvulnerability-themes-cache');
delete_site_option('wpvulnerability-themes-cache');

// Delete Transients
delete_transient('wpvulnerability_message_manual_success');
delete_site_transient('wpvulnerability_message_manual_success');
delete_transient('wpvulnerability_message_manual_error');
delete_site_transient('wpvulnerability_message_manual_error');

// Clear Cron Jobs
wp_clear_scheduled_hook('wpvulnerability_update_database');
wp_clear_scheduled_hook('wpvulnerability_send_notification');
wp_clear_scheduled_hook('wpvulnerability_notification');
wp_clear_scheduled_hook('wpvulnerability_cleanup_logs');

