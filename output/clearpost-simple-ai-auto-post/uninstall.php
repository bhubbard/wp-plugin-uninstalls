<?php

// If uninstall not called from WordPress, then exit.
if ( ! defined( 'WP_UNINSTALL_PLUGIN' ) ) {
	exit;
}

// Delete Options
global $wpdb;
$options = $wpdb->get_col( $wpdb->prepare( "SELECT option_name FROM {$wpdb->options} WHERE option_name LIKE %s", '%_api_key' ) );
foreach ( $options as $opt ) {
	delete_option( $opt );
	delete_site_option( $opt );
}
delete_option('saiap_license_key');
delete_site_option('saiap_license_key');
delete_option('saiap_anthropic_api_key');
delete_site_option('saiap_anthropic_api_key');
delete_option('saiap_gemini_api_key');
delete_site_option('saiap_gemini_api_key');
delete_option('saiap_openai_api_key');
delete_site_option('saiap_openai_api_key');
delete_option('saiap_default_provider');
delete_site_option('saiap_default_provider');
delete_option('saiap_tracking_consent');
delete_site_option('saiap_tracking_consent');
delete_option('saiap_anthropic_model');
delete_site_option('saiap_anthropic_model');
delete_option('saiap_gemini_model');
delete_site_option('saiap_gemini_model');
delete_option('saiap_openai_model');
delete_site_option('saiap_openai_model');
delete_option('saiap_notify_on_schedule');
delete_site_option('saiap_notify_on_schedule');
delete_option('saiap_notify_recipients');
delete_site_option('saiap_notify_recipients');
delete_option('saiap_tracking_prompt_shown');
delete_site_option('saiap_tracking_prompt_shown');
delete_option('saiap_activation_data');
delete_site_option('saiap_activation_data');
delete_option('saiap_review_before_publish');
delete_site_option('saiap_review_before_publish');
delete_option('saiap_post_author');
delete_site_option('saiap_post_author');
delete_option('saiap_link_field_name');
delete_site_option('saiap_link_field_name');
delete_option('saiap_trial_started_at');
delete_site_option('saiap_trial_started_at');
delete_option('saiap_setup_triggered_at');
delete_site_option('saiap_setup_triggered_at');
delete_option('saiap_autopilot_enabled');
delete_site_option('saiap_autopilot_enabled');
delete_option('saiap_posts_per_week');
delete_site_option('saiap_posts_per_week');
delete_option('saiap_post_type');
delete_site_option('saiap_post_type');
delete_option('saiap_context_cache');
delete_site_option('saiap_context_cache');
delete_option('saiap_editor_chat_history');
delete_site_option('saiap_editor_chat_history');
delete_option('saiap_ai_prompt');
delete_site_option('saiap_ai_prompt');
delete_option('saiap_model');
delete_site_option('saiap_model');
delete_option('saiap_trial_source');
delete_site_option('saiap_trial_source');
delete_option('saiap_web_wizard_data');
delete_site_option('saiap_web_wizard_data');
delete_option('saiap_onboarding_wizard_data');
delete_site_option('saiap_onboarding_wizard_data');
delete_option('saiap_context_last_updated');
delete_site_option('saiap_context_last_updated');
delete_option('saiap_site_context');
delete_site_option('saiap_site_context');
delete_option('saiap_context_auto_loaded');
delete_site_option('saiap_context_auto_loaded');
delete_option('saiap_onboarding_dismissed');
delete_site_option('saiap_onboarding_dismissed');
delete_option('saiap_premium_onboarding_dismissed');
delete_site_option('saiap_premium_onboarding_dismissed');
delete_option('saiap_trial_onboarding_dismissed');
delete_site_option('saiap_trial_onboarding_dismissed');
delete_option('saiap_db_version');
delete_site_option('saiap_db_version');
delete_option('saiap_enable_prompt_history');
delete_site_option('saiap_enable_prompt_history');
delete_option('saiap_site_context_data');
delete_site_option('saiap_site_context_data');
delete_option('saiap_custom_site_context');
delete_site_option('saiap_custom_site_context');
delete_option('saiap_context_post_limit');
delete_site_option('saiap_context_post_limit');
delete_option('saiap_context_post_age');
delete_site_option('saiap_context_post_age');
delete_option('saiap_trial_status');
delete_site_option('saiap_trial_status');
delete_option('saiap_trial_expires_at');
delete_site_option('saiap_trial_expires_at');
delete_option('saiap_license_invalid');
delete_site_option('saiap_license_invalid');
delete_option('saiap_last_version_seen');
delete_site_option('saiap_last_version_seen');
delete_option('saiap_wizard_prefill_data');
delete_site_option('saiap_wizard_prefill_data');
delete_option('saiap_first_post_created');
delete_site_option('saiap_first_post_created');
delete_option('saiap_tracking_notice_shown');
delete_site_option('saiap_tracking_notice_shown');
delete_option('saiap_trial_license_key');
delete_site_option('saiap_trial_license_key');
delete_option('saiap_setup_complete');
delete_site_option('saiap_setup_complete');

// Delete Transients
delete_transient('saiap_models_registry_v1');
delete_site_transient('saiap_models_registry_v1');
delete_transient('saiap_show_tracking_notice');
delete_site_transient('saiap_show_tracking_notice');
delete_transient('saiap_calendar_items_count');
delete_site_transient('saiap_calendar_items_count');
delete_transient('saiap_planned_calendar_items_count');
delete_site_transient('saiap_planned_calendar_items_count');
delete_transient('saiap_site_context_data');
delete_site_transient('saiap_site_context_data');
delete_transient('saiap_trial_last_sync');
delete_site_transient('saiap_trial_last_sync');
delete_transient('saiap_show_trial_update_notice');
delete_site_transient('saiap_show_trial_update_notice');
delete_transient('saiap_activation_redirect');
delete_site_transient('saiap_activation_redirect');
delete_transient('saiap_license_last_check');
delete_site_transient('saiap_license_last_check');

// Clear Cron Jobs
wp_clear_scheduled_hook('saiap_refresh_models_registry_event');
wp_clear_scheduled_hook('saiap_generate_scheduled_post');
wp_clear_scheduled_hook('saiap_daily_context_update');

// Clear Metadata
global $wpdb;
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", '_saiap_generated' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", '_saiap_generated' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", '_saiap_generated' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", '_saiap_generated' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", '_clearpost_link' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", '_clearpost_link' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", '_clearpost_link' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", '_clearpost_link' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", '_clearpost_link_title' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", '_clearpost_link_title' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", '_clearpost_link_title' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", '_clearpost_link_title' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", '_saiap_calendar_item_id' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", '_saiap_calendar_item_id' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", '_saiap_calendar_item_id' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", '_saiap_calendar_item_id' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", '_saiap_generated_at' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", '_saiap_generated_at' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", '_saiap_generated_at' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", '_saiap_generated_at' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", '_saiap_image_agent_status' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", '_saiap_image_agent_status' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", '_saiap_image_agent_status' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", '_saiap_image_agent_status' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", '_saiap_inline_images_tasks_v1' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", '_saiap_inline_images_tasks_v1' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", '_saiap_inline_images_tasks_v1' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", '_saiap_inline_images_tasks_v1' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", '_saiap_inline_images_status' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", '_saiap_inline_images_status' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", '_saiap_inline_images_status' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", '_saiap_inline_images_status' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", 'saiap_global_banner_dismissed' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", 'saiap_global_banner_dismissed' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", 'saiap_global_banner_dismissed' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", 'saiap_global_banner_dismissed' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", '_saiap_image_hash' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", '_saiap_image_hash' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", '_saiap_image_hash' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", '_saiap_image_hash' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", '_wp_attachment_image_alt' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", '_wp_attachment_image_alt' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", '_wp_attachment_image_alt' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", '_wp_attachment_image_alt' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", '_saiap_image_source_url' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", '_saiap_image_source_url' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", '_saiap_image_source_url' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", '_saiap_image_source_url' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", '_saiap_image_source_title' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", '_saiap_image_source_title' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", '_saiap_image_source_title' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", '_saiap_image_source_title' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", '_saiap_inline_images_inserted_ids' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", '_saiap_inline_images_inserted_ids' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", '_saiap_inline_images_inserted_ids' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", '_saiap_inline_images_inserted_ids' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", '_saiap_inline_images_last_error' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", '_saiap_inline_images_last_error' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", '_saiap_inline_images_last_error' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", '_saiap_inline_images_last_error' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", '_saiap_image_agent_error' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", '_saiap_image_agent_error' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", '_saiap_image_agent_error' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", '_saiap_image_agent_error' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", '_saiap_first_post' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", '_saiap_first_post' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", '_saiap_first_post' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", '_saiap_first_post' ) );

