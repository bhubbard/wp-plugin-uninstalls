<?php

// If uninstall not called from WordPress, then exit.
if ( ! defined( 'WP_UNINSTALL_PLUGIN' ) ) {
	exit;
}

// Delete Options
delete_option('active_sitewide_plugins');
delete_site_option('active_sitewide_plugins');
delete_option('itsec-storage');
delete_site_option('itsec-storage');
delete_option('itsec_dismissed_notices');
delete_site_option('itsec_dismissed_notices');
delete_option('itsec_remind_me_notices');
delete_site_option('itsec_remind_me_notices');
delete_option('itsec_temp_whitelist_ip');
delete_site_option('itsec_temp_whitelist_ip');
delete_option('itsec_backup');
delete_site_option('itsec_backup');
delete_option('itsec_ban_users');
delete_site_option('itsec_ban_users');
delete_option('itsec_brute_force');
delete_site_option('itsec_brute_force');
delete_option('itsec-enable-encryption-failed');
delete_site_option('itsec-enable-encryption-failed');
delete_option('itsec_file_change_latest');
delete_site_option('itsec_file_change_latest');
delete_option('itsec_file_change');
delete_site_option('itsec_file_change');
delete_option('itsec_local_file_list');
delete_site_option('itsec_local_file_list');
delete_option('itsec_local_file_list_0');
delete_site_option('itsec_local_file_list_0');
delete_option('itsec_local_file_list_1');
delete_site_option('itsec_local_file_list_1');
delete_option('itsec_local_file_list_2');
delete_site_option('itsec_local_file_list_2');
delete_option('itsec_local_file_list_3');
delete_site_option('itsec_local_file_list_3');
delete_option('itsec_local_file_list_4');
delete_site_option('itsec_local_file_list_4');
delete_option('itsec_local_file_list_5');
delete_site_option('itsec_local_file_list_5');
delete_option('itsec_local_file_list_6');
delete_site_option('itsec_local_file_list_6');
delete_option('itsec_file_change_warning');
delete_site_option('itsec_file_change_warning');
delete_option('itsec_file_list');
delete_site_option('itsec_file_list');
delete_option('itsec_file_change_scan_progress');
delete_site_option('itsec_file_change_scan_progress');
delete_option('itsec_global');
delete_site_option('itsec_global');
delete_option('itsec_message_queue');
delete_site_option('itsec_message_queue');
delete_option('itsec_hide_backend_new_slug');
delete_site_option('itsec_hide_backend_new_slug');
delete_option('itsec_hide_backend');
delete_site_option('itsec_hide_backend');
delete_option('itsec_malware_scheduling');
delete_site_option('itsec_malware_scheduling');
delete_option('itsec_malware_scheduling_report_queue');
delete_site_option('itsec_malware_scheduling_report_queue');
delete_option('itsec_malware_scheduling_last_scan');
delete_site_option('itsec_malware_scheduling_last_scan');
delete_option('itsec_ipcheck');
delete_site_option('itsec_ipcheck');
delete_option('itsec_salts');
delete_site_option('itsec_salts');
delete_option('itsec_ssl');
delete_site_option('itsec_ssl');
delete_option('itsec_strong_passwords');
delete_site_option('itsec_strong_passwords');
delete_option('itsec_active_modules');
delete_site_option('itsec_active_modules');
delete_option('ms_files_rewriting');
delete_site_option('ms_files_rewriting');
delete_option('itsec_tweaks');
delete_site_option('itsec_tweaks');
delete_option('itsec_two_factor');
delete_site_option('itsec_two_factor');
delete_option('itsec_data');
delete_site_option('itsec_data');
delete_option('bit51_bwps');
delete_site_option('bit51_bwps');
delete_option('itsec_pro_just_activated');
delete_site_option('itsec_pro_just_activated');
delete_option('itsec_free_just_activated');
delete_site_option('itsec_free_just_activated');
delete_option('itsec-enable-grade-report');
delete_site_option('itsec-enable-grade-report');
delete_option('bwps_intrusion_warning');
delete_site_option('bwps_intrusion_warning');
delete_option('bit51_bwps_data');
delete_site_option('bit51_bwps_data');
delete_option('bwps_file_log');
delete_site_option('bwps_file_log');
delete_option('bwps_awaymode');
delete_site_option('bwps_awaymode');
delete_option('bwps_filecheck');
delete_site_option('bwps_filecheck');
delete_option('BWPS_Login_Slug');
delete_site_option('BWPS_Login_Slug');
delete_option('BWPS_options');
delete_site_option('BWPS_options');
delete_option('BWPS_versions');
delete_site_option('BWPS_versions');
delete_option('itsec_api_nag');
delete_site_option('itsec_api_nag');
delete_option('itsec_initials');
delete_site_option('itsec_initials');
delete_option('itsec_flush_old_rewrites');
delete_site_option('itsec_flush_old_rewrites');
delete_option('itsec_manual_update');
delete_site_option('itsec_manual_update');
delete_option('itsec_rewrites_changed');
delete_site_option('itsec_rewrites_changed');
delete_option('itsec_config_changed');
delete_site_option('itsec_config_changed');
delete_option('itsec_had_other_version');
delete_site_option('itsec_had_other_version');
delete_option('itsec_no_file_lock_release');
delete_site_option('itsec_no_file_lock_release');
delete_option('itsec_clear_login');
delete_site_option('itsec_clear_login');
delete_option('itsec_jquery_version');
delete_site_option('itsec_jquery_version');
delete_option('stellarwp_telemetry');
delete_site_option('stellarwp_telemetry');
delete_option('stellarwp_telemetry_last_send');
delete_site_option('stellarwp_telemetry_last_send');

// Delete Transients
delete_transient('itsec_wp_upload_dir');
delete_site_transient('itsec_wp_upload_dir');
delete_transient('update_plugins');
delete_site_transient('update_plugins');
delete_transient('update_themes');
delete_site_transient('update_themes');
delete_transient('doing_cron');
delete_site_transient('doing_cron');
delete_transient('ithemes-security-news');
delete_site_transient('ithemes-security-news');
delete_transient('ITSEC_SHOW_HIDE_BACKEND_TOOLTIP');
delete_site_transient('ITSEC_SHOW_HIDE_BACKEND_TOOLTIP');
delete_transient('itsec_notification_running');
delete_site_transient('itsec_notification_running');
delete_transient('bit51_bwps_backup');
delete_site_transient('bit51_bwps_backup');
delete_transient('bwps_away');
delete_site_transient('bwps_away');
delete_transient('ITSEC_SHOW_WRITE_FILES_TOOLTIP');
delete_site_transient('ITSEC_SHOW_WRITE_FILES_TOOLTIP');
delete_transient('itsec_upload_dir');
delete_site_transient('itsec_upload_dir');
global $wpdb;
$transients = $wpdb->get_col( $wpdb->prepare( "SELECT option_name FROM {$wpdb->options} WHERE option_name LIKE %s OR option_name LIKE %s", '_transient_%_process_lock', '_site_transient_%_process_lock' ) );
foreach ( $transients as $transient ) {
	delete_option( $transient );
}

// Clear Cron Jobs
wp_clear_scheduled_hook('itsec_cron_test');
wp_clear_scheduled_hook('itsec_execute_backup_cron');
wp_clear_scheduled_hook('itsec_file_check');
wp_clear_scheduled_hook('itsec_execute_file_check_cron');
wp_clear_scheduled_hook('itsec_malware_scheduled_scan');
wp_clear_scheduled_hook('itsec-send-scheduled-notifications');
wp_clear_scheduled_hook('itsec_digest_email');
wp_clear_scheduled_hook('itsec_purge_lockouts');
wp_clear_scheduled_hook('itsec_clear_locks');
wp_clear_scheduled_hook('bwps_backup');

// Clear Metadata
global $wpdb;
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key LIKE %s", '_solid_user_action_%' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key LIKE %s", '_solid_user_action_%' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key LIKE %s", '_solid_user_action_%' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key LIKE %s", '_solid_user_action_%' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", '_itsec_dismissed_notices' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", '_itsec_dismissed_notices' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", '_itsec_dismissed_notices' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", '_itsec_dismissed_notices' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", 'itsec_password_change_required' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", 'itsec_password_change_required' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", 'itsec_password_change_required' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", 'itsec_password_change_required' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", 'itsec_last_password_change' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", 'itsec_last_password_change' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", 'itsec_last_password_change' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", 'itsec_last_password_change' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", 'itsec-password-updated' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", 'itsec-password-updated' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", 'itsec-password-updated' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", 'itsec-password-updated' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", 'itsec_user_activity_last_seen' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", 'itsec_user_activity_last_seen' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", 'itsec_user_activity_last_seen' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", 'itsec_user_activity_last_seen' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", 'itsec_user_activity_last_seen_notification_sent' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", 'itsec_user_activity_last_seen_notification_sent' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", 'itsec_user_activity_last_seen_notification_sent' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", 'itsec_user_activity_last_seen_notification_sent' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", '_new_email' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", '_new_email' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", '_new_email' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", '_new_email' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", '_itsec_has_logged_in' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", '_itsec_has_logged_in' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", '_itsec_has_logged_in' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", '_itsec_has_logged_in' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", 'itsec_enable_ssl' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", 'itsec_enable_ssl' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", 'itsec_enable_ssl' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", 'itsec_enable_ssl' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", 'bwps_enable_ssl' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", 'bwps_enable_ssl' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", 'bwps_enable_ssl' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", 'bwps_enable_ssl' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", '_solid_password_ignore' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", '_solid_password_ignore' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", '_solid_password_ignore' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", '_solid_password_ignore' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", '_solid_2fa_ignore' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", '_solid_2fa_ignore' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", '_solid_2fa_ignore' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", '_solid_2fa_ignore' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", 'itsec_two_factor_enabled' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", 'itsec_two_factor_enabled' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", 'itsec_two_factor_enabled' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", 'itsec_two_factor_enabled' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", 'itsec_two_factor_description' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", 'itsec_two_factor_description' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", 'itsec_two_factor_description' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", 'itsec_two_factor_description' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", 'itsec_two_factor_key' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", 'itsec_two_factor_key' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", 'itsec_two_factor_key' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", 'itsec_two_factor_key' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", 'itsec_two_factor_use_app' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", 'itsec_two_factor_use_app' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", 'itsec_two_factor_use_app' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", 'itsec_two_factor_use_app' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", 'itsec_two_factor_app_pass' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", 'itsec_two_factor_app_pass' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", 'itsec_two_factor_app_pass' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", 'itsec_two_factor_app_pass' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", 'itsec_two_factor_last_login' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", 'itsec_two_factor_last_login' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", 'itsec_two_factor_last_login' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", 'itsec_two_factor_last_login' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", 'itsec_two_factor_override' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", 'itsec_two_factor_override' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", 'itsec_two_factor_override' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", 'itsec_two_factor_override' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", 'itsec_two_factor_override_expires' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", 'itsec_two_factor_override_expires' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", 'itsec_two_factor_override_expires' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", 'itsec_two_factor_override_expires' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", '_two_factor_enabled_providers' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", '_two_factor_enabled_providers' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", '_two_factor_enabled_providers' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", '_two_factor_enabled_providers' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", '_two_factor_provider' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", '_two_factor_provider' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", '_two_factor_provider' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", '_two_factor_provider' ) );

