#!/bin/bash
# WP-CLI Uninstall Script

# Delete Options
wp option delete 'nis2_enabled'
wp option delete 'nis2_data_retention'
wp option delete 'nis2_organization_type'
wp option delete 'nis2_report_language'
wp option delete 'nis2_timezone'
wp option delete 'nis2_logging_enabled'
wp option delete 'nis2_log_retention_days'
wp option delete 'nis2_log_level'
wp option delete 'nis2_log_event_types'
wp option delete 'nis2_log_integration_mode'
wp option delete 'nis2_import_existing_logs'
wp option delete 'nis2_webhook_enabled'
wp option delete 'nis2_webhook_url'
wp option delete 'nis2_webhook_secret'
wp option delete 'nis2_syslog_enabled'
wp option delete 'nis2_email_notifications'
wp option delete 'nis2_alert_frequency'
wp option delete 'nis2_db_optimization'
wp option delete 'nis2_log_compression'
wp option delete 'nis2_rate_limit_enabled'
wp option delete 'nis2_rate_limit_attempts'
wp option delete 'nis2_rate_limit_period'
wp option delete 'nis2_captcha_enabled'
wp option delete 'nis2_captcha_site_key'
wp option delete 'nis2_captcha_secret_key'
wp option delete 'nis2_ip_whitelist'
wp option delete 'nis2_ip_blacklist'
wp option delete 'nis2_blocked_countries'
wp option delete 'nis2_session_timeout'
wp option delete 'nis2_limit_concurrent_sessions'
wp option delete 'nis2_vulnerability_scanning_enabled'
wp option delete 'nis2_vulnerability_scan_frequency'
wp option delete 'nis2_vulnerability_notifications'
wp option delete 'nis2_vulnerability_auto_fix'
wp option delete 'nis2_integrity_enabled'
wp option delete 'nis2_integrity_frequency'
wp option delete 'nis2_integrity_email_alerts'
wp option delete 'nis2_monitor_core'
wp option delete 'nis2_monitor_plugins'
wp option delete 'nis2_monitor_themes'
wp option delete 'nis2_monitor_uploads'
wp option delete 'nis2_monitor_custom_paths'
wp option delete 'nis2_monitor_file_types'
wp option delete 'nis2_monitor_excluded_paths'
wp option delete 'nis2_ignore_temp_files'
wp option delete 'nis2_max_files_per_scan'
wp option delete 'nis2_memory_limit'
wp option delete 'nis2_background_scanning'
wp option delete 'nis2_notification_frequency'
wp option delete 'nis2_notification_emails'
wp option delete 'nis2_notification_levels'
wp option delete 'nis2_email_template'
wp option delete 'nis2_slack_enabled'
wp option delete 'nis2_slack_webhook'
wp option delete 'nis2_slack_channel'
wp option delete 'nis2_slack_severity'
wp option delete 'nis2_telegram_enabled'
wp option delete 'nis2_telegram_bot_token'
wp option delete 'nis2_telegram_chat_id'
wp option delete 'nis2_telegram_severity'
wp option delete 'nis2_custom_webhook_enabled'
wp option delete 'nis2_custom_webhook_urls'
wp option delete 'nis2_webhook_auth_header'
wp option delete 'nis2_webhook_format'
wp option delete 'nis2_security_policy_documented'
wp option delete 'nis2_transparency_enabled'
wp option delete 'nis2_debug_mode'
wp option delete 'nis2_debug_log_path'
wp option delete 'nis2_verbose_logging'
wp option delete 'nis2_api_enabled'
wp option delete 'nis2_api_key'
wp option delete 'nis2_api_rate_limit'
wp option delete 'nis2_api_allowed_ips'
wp option delete 'nis2_table_prefix'
wp option delete 'nis2_auto_optimize_db'
wp option delete 'nis2_auto_create_indexes'
wp option delete 'nis2_query_timeout'
wp option delete 'nis2_dashboard_theme'
wp option delete 'nis2_hide_admin_bar'
wp option delete 'nis2_uninstall_data'
wp option delete 'nis2_export_before_uninstall'
wp option delete 'nis2_api_timeout'
wp option delete 'nis2_cache_duration'
wp option delete 'nis2_plugin_integrations'
wp option delete 'nis2_suppress_mode'
wp option delete 'nis2_report'
wp option delete 'nis2_last_integrity_scan'
wp option delete 'nis2_vuln_auto_scan'
wp option delete 'nis2_vuln_email_alerts'
wp option delete 'nis2_vuln_sources'
wp option delete 'nis2_require_2fa_admin'
wp option delete 'nis2_monitoring_enabled'
wp option delete 'nis2_last_integrity_check'
wp option delete 'nis2_last_vulnerability_scan'
wp option delete 'nis2_incident_procedures_documented'
wp option delete '_nis2_pre_update_version'
wp option delete 'nis2_custom_monitored_paths'
wp option delete 'nis2_scan_frequency'
wp option delete 'nis2_wpscan_api_token'
wp option delete 'nis2_db_version'
wp db query "DELETE FROM wp_options WHERE option_name LIKE 'nis2_%'"
wp option delete 'nis2_public_transparency'
wp option delete 'nis2_footer_badge'
wp option delete 'nis2_last_security_update'

# Delete Transients
wp transient delete 'update_core'
wp transient delete 'nis2_blocked_ips'
wp db query "DELETE FROM wp_options WHERE option_name LIKE '_transient_nis2_attempts_%' OR option_name LIKE '_site_transient_nis2_attempts_%'"
wp transient delete 'nis2_integrity_scan_running'

# Clear Cron Jobs
wp cron event delete 'nis2_integrity_check'
wp cron event delete 'nis2_vulnerability_check'
wp cron event delete 'nis2_daily_scan'

# Direct DB Queries (Fallback)
wp db query "DELETE FROM wp_postmeta WHERE meta_key = 'nis2_2fa_code'"
wp db query "DELETE FROM wp_usermeta WHERE meta_key = 'nis2_2fa_code'"
wp db query "DELETE FROM wp_termmeta WHERE meta_key = 'nis2_2fa_code'"
wp db query "DELETE FROM wp_commentmeta WHERE meta_key = 'nis2_2fa_code'"
wp db query "DELETE FROM wp_postmeta WHERE meta_key = 'nis2_2fa_expires'"
wp db query "DELETE FROM wp_usermeta WHERE meta_key = 'nis2_2fa_expires'"
wp db query "DELETE FROM wp_termmeta WHERE meta_key = 'nis2_2fa_expires'"
wp db query "DELETE FROM wp_commentmeta WHERE meta_key = 'nis2_2fa_expires'"
