<?php

// If uninstall not called from WordPress, then exit.
if ( ! defined( 'WP_UNINSTALL_PLUGIN' ) ) {
	exit;
}

// Delete Options
delete_option('mamba_enable_page_cache');
delete_site_option('mamba_enable_page_cache');
delete_option('mamba_cache_stats');
delete_site_option('mamba_cache_stats');
delete_option('mamba_warmup_stats');
delete_site_option('mamba_warmup_stats');
delete_option('mamba_daily_stats');
delete_site_option('mamba_daily_stats');
delete_option('mamba_enable_store_api_cache');
delete_site_option('mamba_enable_store_api_cache');
delete_option('mamba_cache_ttl');
delete_site_option('mamba_cache_ttl');
delete_option('mamba_browser_ttl');
delete_site_option('mamba_browser_ttl');
delete_option('mamba_store_api_browser_ttl');
delete_site_option('mamba_store_api_browser_ttl');
delete_option('mamba_store_api_ttl');
delete_site_option('mamba_store_api_ttl');
delete_option('mamba_cache_size_limit');
delete_site_option('mamba_cache_size_limit');
delete_option('mamba_cdn_ttl');
delete_site_option('mamba_cdn_ttl');
delete_option('mamba_stale_if_error');
delete_site_option('mamba_stale_if_error');
delete_option('mamba_enable_priority_warmup');
delete_site_option('mamba_enable_priority_warmup');
delete_option('mamba_stats_last_write');
delete_site_option('mamba_stats_last_write');
delete_option('mamba_ns_mamba_store_api');
delete_site_option('mamba_ns_mamba_store_api');
delete_option('mamba_ns_mamba_tags');
delete_site_option('mamba_ns_mamba_tags');
delete_option('mamba_ns_mamba_stats');
delete_site_option('mamba_ns_mamba_stats');
delete_option('mamba_ns_mamba_cart_fragments');
delete_site_option('mamba_ns_mamba_cart_fragments');
delete_option('mamba_welcome_shown');
delete_site_option('mamba_welcome_shown');
delete_option('mamba_first_visit_done');
delete_site_option('mamba_first_visit_done');
delete_option('active_sitewide_plugins');
delete_site_option('active_sitewide_plugins');
delete_option('mamba_license_key');
delete_site_option('mamba_license_key');
delete_option('mamba_license_status');
delete_site_option('mamba_license_status');
delete_option('mamba_license_last_ok');
delete_site_option('mamba_license_last_ok');
delete_option('mamba_license_server_url');
delete_site_option('mamba_license_server_url');
delete_option('mamba_auto_setup_done');
delete_site_option('mamba_auto_setup_done');
delete_option('mamba_preload_concurrency');
delete_site_option('mamba_preload_concurrency');
delete_option('mamba_warmup_batch_size');
delete_site_option('mamba_warmup_batch_size');
delete_option('mamba_include_accept_language_vary');
delete_site_option('mamba_include_accept_language_vary');
delete_option('mamba_last_sale_event_check');
delete_site_option('mamba_last_sale_event_check');
delete_option('mamba_cache_last_cleanup');
delete_site_option('mamba_cache_last_cleanup');
delete_option('mamba_do_activation_redirect');
delete_site_option('mamba_do_activation_redirect');
delete_option('mamba_hourly_stats');
delete_site_option('mamba_hourly_stats');
delete_option('mamba_stats_last_hourly');
delete_site_option('mamba_stats_last_hourly');
delete_option('mamba_pretty_permalinks_done');
delete_site_option('mamba_pretty_permalinks_done');
delete_option('mamba_cdn_actions');
delete_site_option('mamba_cdn_actions');
delete_option('mamba_cdn_autoload_migrated');
delete_site_option('mamba_cdn_autoload_migrated');
delete_option('mamba_warmup_errors');
delete_site_option('mamba_warmup_errors');
delete_option('mamba_admin_notifications');
delete_site_option('mamba_admin_notifications');
delete_option('mamba_debug_mode');
delete_site_option('mamba_debug_mode');
delete_option('mamba_enable_logging');
delete_site_option('mamba_enable_logging');
delete_option('mamba_log_level');
delete_site_option('mamba_log_level');
delete_option('mamba_log_retention_days');
delete_site_option('mamba_log_retention_days');
delete_option('mamba_savings_stats');
delete_site_option('mamba_savings_stats');
delete_option('mamba_enable_webp_conversion');
delete_site_option('mamba_enable_webp_conversion');
delete_option('mamba_webp_quality');
delete_site_option('mamba_webp_quality');
delete_option('mamba_convert_full_size');
delete_site_option('mamba_convert_full_size');
delete_option('mamba_enable_image_compression');
delete_site_option('mamba_enable_image_compression');
delete_option('mamba_compression_quality');
delete_site_option('mamba_compression_quality');
delete_option('mamba_compression_type');
delete_site_option('mamba_compression_type');
delete_option('mamba_compress_full_size');
delete_site_option('mamba_compress_full_size');
delete_option('mamba_enable_lcp_optimization');
delete_site_option('mamba_enable_lcp_optimization');
delete_option('mamba_enable_avif_conversion');
delete_site_option('mamba_enable_avif_conversion');
delete_option('mamba_avif_quality');
delete_site_option('mamba_avif_quality');
delete_option('mamba_convert_full_size_avif');
delete_site_option('mamba_convert_full_size_avif');
delete_option('mamba_add_image_dimensions');
delete_site_option('mamba_add_image_dimensions');
delete_option('mamba_disable_wc_assets_on_non_wc');
delete_site_option('mamba_disable_wc_assets_on_non_wc');
delete_option('mamba_disable_order_splitter_async');
delete_site_option('mamba_disable_order_splitter_async');
delete_option('mamba_simplify_price_html');
delete_site_option('mamba_simplify_price_html');
delete_option('mamba_enable_hover_prefetch');
delete_site_option('mamba_enable_hover_prefetch');
delete_option('mamba_optimize_checkout_js');
delete_site_option('mamba_optimize_checkout_js');
delete_option('mamba_optimize_checkout_css');
delete_site_option('mamba_optimize_checkout_css');
delete_option('mamba_disable_checkout_fragments');
delete_site_option('mamba_disable_checkout_fragments');
delete_option('mamba_lazy_load_payments');
delete_site_option('mamba_lazy_load_payments');
delete_option('mamba_defer_transactional_emails');
delete_site_option('mamba_defer_transactional_emails');
delete_option('mamba_preconnect_payment_sdks');
delete_site_option('mamba_preconnect_payment_sdks');
delete_option('mamba_disable_woo_marketplace_suggestions');
delete_site_option('mamba_disable_woo_marketplace_suggestions');
delete_option('mamba_suppress_woo_helper_notices');
delete_site_option('mamba_suppress_woo_helper_notices');
delete_option('mamba_disable_woo_payment_gateway_suggestions');
delete_site_option('mamba_disable_woo_payment_gateway_suggestions');
delete_option('mamba_remove_woo_submenus');
delete_site_option('mamba_remove_woo_submenus');
delete_option('mamba_disable_order_attribution');
delete_site_option('mamba_disable_order_attribution');
delete_option('mamba_enable_html_minify');
delete_site_option('mamba_enable_html_minify');
delete_option('mamba_html_minify_mode');
delete_site_option('mamba_html_minify_mode');
delete_option('mamba_enable_font_preload');
delete_site_option('mamba_enable_font_preload');
delete_option('mamba_preload_fonts');
delete_site_option('mamba_preload_fonts');
delete_option('mamba_enable_dns_prefetch');
delete_site_option('mamba_enable_dns_prefetch');
delete_option('mamba_dns_prefetch_domains');
delete_site_option('mamba_dns_prefetch_domains');
delete_option('mamba_dns_prefetch_auto_detect');
delete_site_option('mamba_dns_prefetch_auto_detect');
delete_option('mamba_enable_preconnect');
delete_site_option('mamba_enable_preconnect');
delete_option('mamba_preconnect_domains');
delete_site_option('mamba_preconnect_domains');
delete_option('mamba_heartbeat_frontend');
delete_site_option('mamba_heartbeat_frontend');
delete_option('mamba_heartbeat_admin');
delete_site_option('mamba_heartbeat_admin');
delete_option('mamba_heartbeat_editor');
delete_site_option('mamba_heartbeat_editor');
delete_option('mamba_enable_adaptive_ttl');
delete_site_option('mamba_enable_adaptive_ttl');
delete_option('mamba_enable_critical_css');
delete_site_option('mamba_enable_critical_css');
delete_option('mamba_enable_css_defer');
delete_site_option('mamba_enable_css_defer');
delete_option('mamba_css_defer_all');
delete_site_option('mamba_css_defer_all');
delete_option('mamba_critical_css_force_include');
delete_site_option('mamba_critical_css_force_include');
delete_option('mamba_critical_css_custom_product');
delete_site_option('mamba_critical_css_custom_product');
delete_option('mamba_critical_css_custom_shop');
delete_site_option('mamba_critical_css_custom_shop');
delete_option('mamba_critical_css_custom_category');
delete_site_option('mamba_critical_css_custom_category');
delete_option('mamba_critical_css_custom_cart');
delete_site_option('mamba_critical_css_custom_cart');
delete_option('mamba_critical_css_custom_checkout');
delete_site_option('mamba_critical_css_custom_checkout');
delete_option('mamba_critical_css_custom_account');
delete_site_option('mamba_critical_css_custom_account');
delete_option('mamba_critical_css_custom_generic');
delete_site_option('mamba_critical_css_custom_generic');
delete_option('mamba_enable_js_delay');
delete_site_option('mamba_enable_js_delay');
delete_option('mamba_js_delay_timeout');
delete_site_option('mamba_js_delay_timeout');
delete_option('mamba_js_delay_scripts');
delete_site_option('mamba_js_delay_scripts');
delete_option('mamba_js_delay_exclusions');
delete_site_option('mamba_js_delay_exclusions');
delete_option('mamba_warmup_priority_mode');
delete_site_option('mamba_warmup_priority_mode');
delete_option('mamba_warmup_selective_mode');
delete_site_option('mamba_warmup_selective_mode');
delete_option('mamba_warmup_schedule_enabled');
delete_site_option('mamba_warmup_schedule_enabled');
delete_option('mamba_warmup_schedule_time');
delete_site_option('mamba_warmup_schedule_time');
delete_option('mamba_warmup_selected_categories');
delete_site_option('mamba_warmup_selected_categories');
delete_option('mamba_warmup_selected_products');
delete_site_option('mamba_warmup_selected_products');
delete_option('mamba_warmup_exclusions');
delete_site_option('mamba_warmup_exclusions');
delete_option('mamba_cdn_provider');
delete_site_option('mamba_cdn_provider');
delete_option('mamba_cloudflare_zone_id');
delete_site_option('mamba_cloudflare_zone_id');
delete_option('mamba_cloudflare_api_token');
delete_site_option('mamba_cloudflare_api_token');
delete_option('mamba_cloudflare_detect_apo');
delete_site_option('mamba_cloudflare_detect_apo');
delete_option('mamba_cloudflare_send_cache_tags');
delete_site_option('mamba_cloudflare_send_cache_tags');
delete_option('mamba_cloudflare_apo_status');
delete_site_option('mamba_cloudflare_apo_status');
delete_option('mamba_cloudflare_rocket_loader_status');
delete_site_option('mamba_cloudflare_rocket_loader_status');
delete_option('mamba_bunny_pull_zone_id');
delete_site_option('mamba_bunny_pull_zone_id');
delete_option('mamba_bunny_api_key');
delete_site_option('mamba_bunny_api_key');
delete_option('mamba_bunny_send_cdn_tags');
delete_site_option('mamba_bunny_send_cdn_tags');
delete_option('mamba_bunny_use_wildcard_purges');
delete_site_option('mamba_bunny_use_wildcard_purges');
delete_option('mamba_generic_webhook_url');
delete_site_option('mamba_generic_webhook_url');
delete_option('mamba_generic_webhook_secret');
delete_site_option('mamba_generic_webhook_secret');
delete_option('mamba_fastly_service_id');
delete_site_option('mamba_fastly_service_id');
delete_option('mamba_fastly_api_token');
delete_site_option('mamba_fastly_api_token');
delete_option('mamba_fastly_send_surrogate_keys');
delete_site_option('mamba_fastly_send_surrogate_keys');
delete_option('mamba_fastly_soft_purge');
delete_site_option('mamba_fastly_soft_purge');
delete_option('mamba_cdn_enable_rewriting');
delete_site_option('mamba_cdn_enable_rewriting');
delete_option('mamba_cdn_hostname');
delete_site_option('mamba_cdn_hostname');
delete_option('mamba_cdn_dirs');
delete_site_option('mamba_cdn_dirs');
delete_option('mamba_cdn_exclusions');
delete_site_option('mamba_cdn_exclusions');
delete_option('mamba_cdn_buffer_rewriting');
delete_site_option('mamba_cdn_buffer_rewriting');
delete_option('mamba_db_optimizer_settings');
delete_site_option('mamba_db_optimizer_settings');
delete_option('cloudflare_apo_enabled');
delete_site_option('cloudflare_apo_enabled');
delete_option('woocommerce_default_customer_address');
delete_site_option('woocommerce_default_customer_address');
delete_option('cloudflare_api_token');
delete_site_option('cloudflare_api_token');
delete_option('cloudflare_zone_id');
delete_site_option('cloudflare_zone_id');
delete_option('cloudflare_rocket_loader');
delete_site_option('cloudflare_rocket_loader');
delete_option('cf_api_token');
delete_site_option('cf_api_token');
delete_option('cloudflare_api_key');
delete_site_option('cloudflare_api_key');
delete_option('cf_zone_id');
delete_site_option('cf_zone_id');
delete_option('mamba_cache_size_last_check');
delete_site_option('mamba_cache_size_last_check');
delete_option('mamba_block_indices');
delete_site_option('mamba_block_indices');
delete_option('woocommerce_currency');
delete_site_option('woocommerce_currency');
global $wpdb;
$options = $wpdb->get_col( $wpdb->prepare( "SELECT option_name FROM {$wpdb->options} WHERE option_name LIKE %s", 'mamba_last_sale_event_%' ) );
foreach ( $options as $opt ) {
	delete_option( $opt );
	delete_site_option( $opt );
}
delete_option('woocommerce_tax_display_shop');
delete_site_option('woocommerce_tax_display_shop');
delete_option('mamba_warmup_validation_concurrency');
delete_site_option('mamba_warmup_validation_concurrency');
delete_option('mamba_warmup_max_retries');
delete_site_option('mamba_warmup_max_retries');
delete_option('mamba_warmup_error_rate_threshold');
delete_site_option('mamba_warmup_error_rate_threshold');
delete_option('mamba_warmup_batch_delay');
delete_site_option('mamba_warmup_batch_delay');
delete_option('woocommerce_default_country');
delete_site_option('woocommerce_default_country');
global $wpdb;
$options = $wpdb->get_col( $wpdb->prepare( "SELECT option_name FROM {$wpdb->options} WHERE option_name LIKE %s", 'mamba_critical_css_custom_%' ) );
foreach ( $options as $opt ) {
	delete_option( $opt );
	delete_site_option( $opt );
}
delete_option('mamba_css_defer_handles');
delete_site_option('mamba_css_defer_handles');
delete_option('mamba_css_defer_excluded');
delete_site_option('mamba_css_defer_excluded');
delete_option('woocommerce_hold_stock_minutes');
delete_site_option('woocommerce_hold_stock_minutes');
delete_option('mamba_nginx_last_webp');
delete_site_option('mamba_nginx_last_webp');
delete_option('mamba_nginx_last_avif');
delete_site_option('mamba_nginx_last_avif');
delete_option('fs_debug_mode');
delete_site_option('fs_debug_mode');
delete_option('_transient_timeout_fs_snooze_period');
delete_site_option('_transient_timeout_fs_snooze_period');
delete_option('_site_transient_timeout_fs_snooze_period');
delete_site_option('_site_transient_timeout_fs_snooze_period');
delete_option('fs_storage_logger');
delete_site_option('fs_storage_logger');
delete_option('fs_active_plugins');
delete_site_option('fs_active_plugins');

// Delete Transients
delete_transient('mamba_license_check_lock');
delete_site_transient('mamba_license_check_lock');
delete_transient('mamba_activation_redirect');
delete_site_transient('mamba_activation_redirect');
global $wpdb;
$transients = $wpdb->get_col( $wpdb->prepare( "SELECT option_name FROM {$wpdb->options} WHERE option_name LIKE %s OR option_name LIKE %s", '_transient_mamba_license_cache_%', '_site_transient_mamba_license_cache_%' ) );
foreach ( $transients as $transient ) {
	delete_option( $transient );
}
delete_transient('mamba_warmup_lock');
delete_site_transient('mamba_warmup_lock');
delete_transient('mamba_stats_flush_lock');
delete_site_transient('mamba_stats_flush_lock');
delete_transient('mamba_cache_counts_cache');
delete_site_transient('mamba_cache_counts_cache');
global $wpdb;
$transients = $wpdb->get_col( $wpdb->prepare( "SELECT option_name FROM {$wpdb->options} WHERE option_name LIKE %s OR option_name LIKE %s", '_transient_mamba_mc_ver_%', '_site_transient_mamba_mc_ver_%' ) );
foreach ( $transients as $transient ) {
	delete_option( $transient );
}
delete_transient('mamba_sched_mamba_cache_preload');
delete_site_transient('mamba_sched_mamba_cache_preload');
delete_transient('mamba_sched_mamba_background_warmup');
delete_site_transient('mamba_sched_mamba_background_warmup');
delete_transient('fs_snooze_period');
delete_site_transient('fs_snooze_period');
delete_transient('update_plugins');
delete_site_transient('update_plugins');
delete_transient('_fs_api_connection_retry_counter');
delete_site_transient('_fs_api_connection_retry_counter');
delete_transient('update_themes');
delete_site_transient('update_themes');

// Clear Cron Jobs
wp_clear_scheduled_hook('mamba_cache_cleanup');
wp_clear_scheduled_hook('mamba_cache_preload');
wp_clear_scheduled_hook('mamba_scheduled_warmup');
wp_clear_scheduled_hook('mamba_license_daily_validation');
wp_clear_scheduled_hook('mamba_cleanup_logs');
wp_clear_scheduled_hook('mamba_stats_flush');
wp_clear_scheduled_hook('mamba_warmup_job');
wp_clear_scheduled_hook('mamba_background_warmup');
wp_clear_scheduled_hook('mamba_priority_warmup');
wp_clear_scheduled_hook('mamba_cache_size_check');
wp_clear_scheduled_hook('mamba_check_sale_boundaries');
wp_clear_scheduled_hook('mamba_block_cache_cleanup');
wp_clear_scheduled_hook('mamba_deferred_wc_variation_clear');
wp_clear_scheduled_hook('mamba_product_sale_event');
wp_clear_scheduled_hook('fs_debug_turn_off_logging_hook');

// Clear Metadata
global $wpdb;
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", '_mamba_webp_conversion' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", '_mamba_webp_conversion' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", '_mamba_webp_conversion' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", '_mamba_webp_conversion' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", '_mamba_compression_quality' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", '_mamba_compression_quality' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", '_mamba_compression_quality' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", '_mamba_compression_quality' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", '_mamba_avif_conversion' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", '_mamba_avif_conversion' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", '_mamba_avif_conversion' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", '_mamba_avif_conversion' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", '_mamba_last_significant_change' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", '_mamba_last_significant_change' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", '_mamba_last_significant_change' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", '_mamba_last_significant_change' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", 'thumbnail_id' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", 'thumbnail_id' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", 'thumbnail_id' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", 'thumbnail_id' ) );

