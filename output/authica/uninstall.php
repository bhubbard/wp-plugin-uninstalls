<?php

// If uninstall not called from WordPress, then exit.
if ( ! defined( 'WP_UNINSTALL_PLUGIN' ) ) {
	exit;
}

// Delete Options
delete_option('authica_version');
delete_site_option('authica_version');
delete_option('authica_license_plan');
delete_site_option('authica_license_plan');
delete_option('authica_whitelabel');
delete_site_option('authica_whitelabel');
delete_option('authica_license_customer');
delete_site_option('authica_license_customer');
delete_option('authica_preview_page_id');
delete_site_option('authica_preview_page_id');
delete_option('authica_redirect_respect_param');
delete_site_option('authica_redirect_respect_param');
delete_option('authica_redirect_fallback');
delete_site_option('authica_redirect_fallback');
delete_option('authica_redirect_roles');
delete_site_option('authica_redirect_roles');
delete_option('authica_redirect_logout');
delete_site_option('authica_redirect_logout');
delete_option('authica_is_pro');
delete_site_option('authica_is_pro');
delete_option('authica_demo_cleanup_done');
delete_site_option('authica_demo_cleanup_done');
delete_option('authica_brute_deny_meta');
delete_site_option('authica_brute_deny_meta');
delete_option('authica_stealth_404_meta');
delete_site_option('authica_stealth_404_meta');
delete_option('authica_ip_deny_list');
delete_site_option('authica_ip_deny_list');
delete_option('authica_brute_last_cleanup');
delete_site_option('authica_brute_last_cleanup');
delete_option('authica_ip_restriction_enabled');
delete_site_option('authica_ip_restriction_enabled');
delete_option('authica_ip_apply_login');
delete_site_option('authica_ip_apply_login');
delete_option('authica_turnstile_secret_key');
delete_site_option('authica_turnstile_secret_key');
delete_option('authica_email_verification_subject');
delete_site_option('authica_email_verification_subject');
delete_option('authica_email_verification_message');
delete_site_option('authica_email_verification_message');
delete_option('authica_email_verification_enabled');
delete_site_option('authica_email_verification_enabled');
delete_option('authica_bot_protection_enabled');
delete_site_option('authica_bot_protection_enabled');
delete_option('authica_ip_allow_list');
delete_site_option('authica_ip_allow_list');
delete_option('authica_ip_allow_meta');
delete_site_option('authica_ip_allow_meta');
delete_option('authica_ip_allow_last_cleanup');
delete_site_option('authica_ip_allow_last_cleanup');
delete_option('authica_wp_login_block_mode');
delete_site_option('authica_wp_login_block_mode');
delete_option('authica_redirect_rules');
delete_site_option('authica_redirect_rules');
delete_option('authica_public_login_slug');
delete_site_option('authica_public_login_slug');
delete_option('authica_login_slug');
delete_site_option('authica_login_slug');
delete_option('authica_housekeeping_last');
delete_site_option('authica_housekeeping_last');
delete_option('authica_brute_retention_days');
delete_site_option('authica_brute_retention_days');
delete_option('authica_stealth_404_enabled');
delete_site_option('authica_stealth_404_enabled');
delete_option('authica_stealth_404_duration');
delete_site_option('authica_stealth_404_duration');
delete_option('authica_brute_total_blocked');
delete_site_option('authica_brute_total_blocked');
delete_option('authica_turnstile_enabled');
delete_site_option('authica_turnstile_enabled');
delete_option('authica_turnstile_sitekey');
delete_site_option('authica_turnstile_sitekey');
delete_option('authica_turnstile_secret');
delete_site_option('authica_turnstile_secret');
delete_option('authica_hide_login_enabled');
delete_site_option('authica_hide_login_enabled');
delete_option('authica_block_page_id');
delete_site_option('authica_block_page_id');
delete_option('authica_ip_default_policy');
delete_site_option('authica_ip_default_policy');
delete_option('authica_brute_enabled');
delete_site_option('authica_brute_enabled');
delete_option('authica_brute_threshold');
delete_site_option('authica_brute_threshold');
delete_option('authica_brute_window');
delete_site_option('authica_brute_window');
delete_option('authica_stealth_404_threshold');
delete_site_option('authica_stealth_404_threshold');
delete_option('authica_logging_enabled');
delete_site_option('authica_logging_enabled');
delete_option('authica_alerts_enabled');
delete_site_option('authica_alerts_enabled');
delete_option('authica_logging_retention_days');
delete_site_option('authica_logging_retention_days');
delete_option('authica_logging_max_rows');
delete_site_option('authica_logging_max_rows');
delete_option('authica_emergency_lockout');
delete_site_option('authica_emergency_lockout');
delete_option('authica_email_verification_expiry');
delete_site_option('authica_email_verification_expiry');
delete_option('authica_email_verification_resend_cooldown');
delete_site_option('authica_email_verification_resend_cooldown');
delete_option('authica_turnstile_analytics_enabled');
delete_site_option('authica_turnstile_analytics_enabled');
delete_option('authica_2fa_enforcement');
delete_site_option('authica_2fa_enforcement');
delete_option('authica_2fa_scope');
delete_site_option('authica_2fa_scope');
delete_option('authica_social_login_enabled');
delete_site_option('authica_social_login_enabled');
delete_option('authica_social_login_providers');
delete_site_option('authica_social_login_providers');
delete_option('authica_turnstile_analytics_api_token');
delete_site_option('authica_turnstile_analytics_api_token');
delete_option('authica_turnstile_analytics_account_id');
delete_site_option('authica_turnstile_analytics_account_id');
delete_option('authica_turnstile_analytics_range_days');
delete_site_option('authica_turnstile_analytics_range_days');
delete_option('authica_ip_apply_admin');
delete_site_option('authica_ip_apply_admin');
delete_option('authica_ip_apply_xmlrpc');
delete_site_option('authica_ip_apply_xmlrpc');
delete_option('authica_ip_apply_rest');
delete_site_option('authica_ip_apply_rest');
delete_option('authica_ip_generic_message');
delete_site_option('authica_ip_generic_message');
delete_option('authica_turnstile_mode');
delete_site_option('authica_turnstile_mode');
delete_option('authica_2fa_remember_enabled');
delete_site_option('authica_2fa_remember_enabled');
delete_option('authica_2fa_remember_days');
delete_site_option('authica_2fa_remember_days');
delete_option('fs_debug_mode');
delete_site_option('fs_debug_mode');
delete_option('_transient_timeout_fs_snooze_period');
delete_site_option('_transient_timeout_fs_snooze_period');
delete_option('_site_transient_timeout_fs_snooze_period');
delete_site_option('_site_transient_timeout_fs_snooze_period');
delete_option('active_sitewide_plugins');
delete_site_option('active_sitewide_plugins');
delete_option('fs_storage_logger');
delete_site_option('fs_storage_logger');
delete_option('fs_active_plugins');
delete_site_option('fs_active_plugins');

// Delete Transients
global $wpdb;
$transients = $wpdb->get_col( $wpdb->prepare( "SELECT option_name FROM {$wpdb->options} WHERE option_name LIKE %s OR option_name LIKE %s", '_transient_authica_stealth_404_%', '_site_transient_authica_stealth_404_%' ) );
foreach ( $transients as $transient ) {
	delete_option( $transient );
}
global $wpdb;
$transients = $wpdb->get_col( $wpdb->prepare( "SELECT option_name FROM {$wpdb->options} WHERE option_name LIKE %s OR option_name LIKE %s", '_transient_authica_stealth_hits_%', '_site_transient_authica_stealth_hits_%' ) );
foreach ( $transients as $transient ) {
	delete_option( $transient );
}
delete_transient('authica_turnstile_fail_open_active');
delete_site_transient('authica_turnstile_fail_open_active');
delete_transient('fs_snooze_period');
delete_site_transient('fs_snooze_period');
delete_transient('update_plugins');
delete_site_transient('update_plugins');
delete_transient('_fs_api_connection_retry_counter');
delete_site_transient('_fs_api_connection_retry_counter');
delete_transient('update_themes');
delete_site_transient('update_themes');

// Clear Cron Jobs
wp_clear_scheduled_hook('authica_ts_analytics_cron');
wp_clear_scheduled_hook('authica_brute_cleanup_event');
wp_clear_scheduled_hook('fs_debug_turn_off_logging_hook');

// Clear Metadata
global $wpdb;
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", '_wp_page_template' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", '_wp_page_template' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", '_wp_page_template' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", '_wp_page_template' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", 'authica_dismissed_notices' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", 'authica_dismissed_notices' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", 'authica_dismissed_notices' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", 'authica_dismissed_notices' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", 'authica_verification_last_sent' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", 'authica_verification_last_sent' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", 'authica_verification_last_sent' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", 'authica_verification_last_sent' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", 'authica_email_verified' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", 'authica_email_verified' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", 'authica_email_verified' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", 'authica_email_verified' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", 'authica_email_verification_token' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", 'authica_email_verification_token' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", 'authica_email_verification_token' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", 'authica_email_verification_token' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", 'authica_email_verification_time' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", 'authica_email_verification_time' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", 'authica_email_verification_time' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", 'authica_email_verification_time' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->postmeta} WHERE meta_key = %s", 'authica_verification_sent' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->usermeta} WHERE meta_key = %s", 'authica_verification_sent' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->termmeta} WHERE meta_key = %s", 'authica_verification_sent' ) );
$wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->commentmeta} WHERE meta_key = %s", 'authica_verification_sent' ) );

