#!/bin/bash
# WP-CLI Uninstall Script

# Delete Options
wp option delete 'twebsec_2fa_enabled_roles'
wp option delete 'twebsec_maintenance_mode'
wp option delete 'twebsec_disable_right_click'
wp option delete 'twebsec_disable_text_select'
wp option delete 'twebsec_block_hotlinking'
wp option delete 'twebsec_enforce_strong_password'
wp option delete 'twebsec_limit_login_attempts'
wp option delete 'twebsec_disable_user_enumeration'
wp option delete 'twebsec_instantly_lockout_invalid_usernames'
wp option delete 'twebsec_force_user_logout'
wp option delete 'twebsec_enable_login_lockout'
wp option delete 'twebsec_scan_core'
wp option delete 'twebsec_scan_themes'
wp option delete 'twebsec_scan_plugins'
wp option delete 'twebsec_scan_malware'
wp option delete 'twebsec_scan_uploads'
wp option delete 'twebsec_auto_db_backup'
wp option delete 'twebsec_enable_scheduled_scan'
wp option delete 'twebsec_disable_file_edit'
wp option delete 'twebsec_block_php_uploads'
wp option delete 'twebsec_block_dangerous_uploads'
wp option delete 'twebsec_disable_xmlrpc'
wp option delete 'twebsec_hide_version'
wp option delete 'twebsec_force_ssl'
wp option delete 'twebsec_hide_login'
wp option delete 'twebsec_restrict_admin_ip'
wp option delete 'twebsec_protect_sensitive_files'
wp option delete 'twebsec_firewall_options'
wp option delete 'twebsec_monitor_core_files'
wp option delete 'twebsec_monitor_plugins'
wp option delete 'twebsec_monitor_themes'
wp option delete 'twebsec_monitor_uploads'
wp option delete 'twebsec_alert_on_file_change'
wp option delete 'twebsec_email_notifications'
wp option delete 'twebsec_notify_file_changes'
wp option delete 'twebsec_notify_malware'
wp option delete 'twebsec_notify_login_failures'
wp option delete 'twebsec_notify_admin_login'
wp option delete 'twebsec_notify_plugin_changes'
wp option delete 'twebsec_notify_theme_changes'
wp option delete 'twebsec_notify_db_backup'
wp option delete 'twebsec_weekly_report'
wp option delete 'twebsec_latest_malware_scan_id'
wp db query "DELETE FROM wp_options WHERE option_name LIKE 'twebsec_malware_scan_status_%'"
wp option delete 'twebsec_malware_threats'
wp option delete 'twebsec_hotlink_protection_enabled'
wp option delete 'twebsec_import_settings'
wp option delete 'twebsec_audit_log_settings'
wp db query "DELETE FROM wp_options WHERE option_name LIKE '%_audit_log_settings'"
wp option delete 'twebsec_max_attempts'
wp option delete 'twebsec_lockout_duration'
wp option delete 'twebsec_login_slug'
wp option delete 'twebsec_scan_frequency'
wp option delete 'twebsec_enable_malware_scan_scheduled'
wp option delete 'twebsec_db_backup_frequency'
wp option delete 'twebsec_notification_email'
wp option delete 'twebsec_allowed_ips'
wp option delete 'twebsec_log_retention'
wp option delete 'twebsec_block_php_uploads_enabled'
wp option delete 'twebsec_block_xmlrpc_requests_enabled'
wp option delete 'twebsec_protect_sensitive_files_enabled'
wp option delete 'twebsec_firewall_general'
wp db query "DELETE FROM wp_options WHERE option_name LIKE '%_modified'"
wp option delete 'twebsec_enable_email_notifications'
wp option delete 'twebsec_restricted_ips'
wp option delete 'twebsec_firewall_smart_404'
wp db query "DELETE FROM wp_options WHERE option_name LIKE '_transient_timeout_%'"
wp option delete 'twebsec_hardening_options'
wp option delete 'twebsec_captcha_enabled_forms'
wp option delete 'twebsec_captcha_type'
wp option delete 'twebsec_recaptcha_site_key'
wp option delete 'twebsec_hcaptcha_site_key'
wp option delete 'twebsec_recaptcha_secret_key'
wp option delete 'twebsec_hcaptcha_secret_key'
wp option delete 'twebsec_login_logo_id'
wp option delete 'twebsec_invalid_usernames_list'
wp option delete 'twebsec_force_user_logout_duration'
wp option delete 'woocommerce_myaccount_page_id'
wp option delete 'twebsec_monitoring_options'

# Delete Transients
wp transient delete 'twebsec_admin_notices'
wp transient delete 'update_plugins'
wp transient delete 'update_themes'
wp transient delete 'twebsec_scan_progress'
wp db query "DELETE FROM wp_options WHERE option_name LIKE '_transient_twebsec_requests_%' OR option_name LIKE '_site_transient_twebsec_requests_%'"
wp db query "DELETE FROM wp_options WHERE option_name LIKE '_transient_twebsec_temp_block_%' OR option_name LIKE '_site_transient_twebsec_temp_block_%'"
wp db query "DELETE FROM wp_options WHERE option_name LIKE '_transient_twebsec_math_captcha_%' OR option_name LIKE '_site_transient_twebsec_math_captcha_%'"
wp transient delete 'settings_errors'

# Clear Cron Jobs
wp cron event delete 'twebsec_daily_cron'
wp cron event delete 'twebsec_file_change_scan'
wp cron event delete 'twebsec_run_malware_scan'
wp cron event delete 'twebsec_db_backup'
wp cron event delete 'twebsec_daily_blacklist_update'
wp cron event delete 'twebsec_cleanup_logs_daily'
wp cron event delete 'twebsec_daily_security_summary'

# Direct DB Queries (Fallback)
wp db query "DELETE FROM wp_postmeta WHERE meta_key = '_twebsec_2fa_enabled'"
wp db query "DELETE FROM wp_usermeta WHERE meta_key = '_twebsec_2fa_enabled'"
wp db query "DELETE FROM wp_termmeta WHERE meta_key = '_twebsec_2fa_enabled'"
wp db query "DELETE FROM wp_commentmeta WHERE meta_key = '_twebsec_2fa_enabled'"
wp db query "DELETE FROM wp_postmeta WHERE meta_key = 'twebsec_last_activity'"
wp db query "DELETE FROM wp_usermeta WHERE meta_key = 'twebsec_last_activity'"
wp db query "DELETE FROM wp_termmeta WHERE meta_key = 'twebsec_last_activity'"
wp db query "DELETE FROM wp_commentmeta WHERE meta_key = 'twebsec_last_activity'"
wp db query "DELETE FROM wp_postmeta WHERE meta_key = '_twebsec_2fa_emergency_codes'"
wp db query "DELETE FROM wp_usermeta WHERE meta_key = '_twebsec_2fa_emergency_codes'"
wp db query "DELETE FROM wp_termmeta WHERE meta_key = '_twebsec_2fa_emergency_codes'"
wp db query "DELETE FROM wp_commentmeta WHERE meta_key = '_twebsec_2fa_emergency_codes'"
wp db query "DELETE FROM wp_postmeta WHERE meta_key = '_twebsec_2fa_secret'"
wp db query "DELETE FROM wp_usermeta WHERE meta_key = '_twebsec_2fa_secret'"
wp db query "DELETE FROM wp_termmeta WHERE meta_key = '_twebsec_2fa_secret'"
wp db query "DELETE FROM wp_commentmeta WHERE meta_key = '_twebsec_2fa_secret'"
wp db query "DELETE FROM wp_postmeta WHERE meta_key = 'twebsec_cached_caps_old'"
wp db query "DELETE FROM wp_usermeta WHERE meta_key = 'twebsec_cached_caps_old'"
wp db query "DELETE FROM wp_termmeta WHERE meta_key = 'twebsec_cached_caps_old'"
wp db query "DELETE FROM wp_commentmeta WHERE meta_key = 'twebsec_cached_caps_old'"
