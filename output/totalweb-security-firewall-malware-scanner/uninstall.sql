-- WordPress Plugin Uninstall SQL Script

-- Delete Options & Transients
DELETE FROM wp_options WHERE option_name IN ('twebsec_2fa_enabled_roles', 'twebsec_maintenance_mode', 'twebsec_disable_right_click', 'twebsec_disable_text_select', 'twebsec_block_hotlinking', 'twebsec_enforce_strong_password', 'twebsec_limit_login_attempts', 'twebsec_disable_user_enumeration', 'twebsec_instantly_lockout_invalid_usernames', 'twebsec_force_user_logout', 'twebsec_enable_login_lockout', 'twebsec_scan_core', 'twebsec_scan_themes', 'twebsec_scan_plugins', 'twebsec_scan_malware', 'twebsec_scan_uploads', 'twebsec_auto_db_backup', 'twebsec_enable_scheduled_scan', 'twebsec_disable_file_edit', 'twebsec_block_php_uploads', 'twebsec_block_dangerous_uploads', 'twebsec_disable_xmlrpc', 'twebsec_hide_version', 'twebsec_force_ssl', 'twebsec_hide_login', 'twebsec_restrict_admin_ip', 'twebsec_protect_sensitive_files', 'twebsec_firewall_options', 'twebsec_monitor_core_files', 'twebsec_monitor_plugins', 'twebsec_monitor_themes', 'twebsec_monitor_uploads', 'twebsec_alert_on_file_change', 'twebsec_email_notifications', 'twebsec_notify_file_changes', 'twebsec_notify_malware', 'twebsec_notify_login_failures', 'twebsec_notify_admin_login', 'twebsec_notify_plugin_changes', 'twebsec_notify_theme_changes', 'twebsec_notify_db_backup', 'twebsec_weekly_report', 'twebsec_latest_malware_scan_id', 'twebsec_malware_threats', 'twebsec_hotlink_protection_enabled', 'twebsec_import_settings', 'twebsec_audit_log_settings', 'twebsec_max_attempts', 'twebsec_lockout_duration', 'twebsec_login_slug');
DELETE FROM wp_options WHERE option_name IN ('twebsec_scan_frequency', 'twebsec_enable_malware_scan_scheduled', 'twebsec_db_backup_frequency', 'twebsec_notification_email', 'twebsec_allowed_ips', 'twebsec_log_retention', 'twebsec_block_php_uploads_enabled', 'twebsec_block_xmlrpc_requests_enabled', 'twebsec_protect_sensitive_files_enabled', 'twebsec_firewall_general', 'twebsec_enable_email_notifications', 'twebsec_restricted_ips', 'twebsec_firewall_smart_404', 'twebsec_hardening_options', 'twebsec_captcha_enabled_forms', 'twebsec_captcha_type', 'twebsec_recaptcha_site_key', 'twebsec_hcaptcha_site_key', 'twebsec_recaptcha_secret_key', 'twebsec_hcaptcha_secret_key', 'twebsec_login_logo_id', 'twebsec_invalid_usernames_list', 'twebsec_force_user_logout_duration', 'woocommerce_myaccount_page_id', 'twebsec_monitoring_options', 'twebsec_admin_notices', 'update_plugins', 'update_themes', 'twebsec_scan_progress', 'settings_errors');
DELETE FROM wp_options WHERE option_name LIKE 'twebsec_malware_scan_status_%';
DELETE FROM wp_options WHERE option_name LIKE '%_audit_log_settings';
DELETE FROM wp_options WHERE option_name LIKE '%_modified';
DELETE FROM wp_options WHERE option_name LIKE '_transient_timeout_%';
DELETE FROM wp_options WHERE option_name LIKE 'twebsec_requests_%';
DELETE FROM wp_options WHERE option_name LIKE 'twebsec_temp_block_%';
DELETE FROM wp_options WHERE option_name LIKE 'twebsec_math_captcha_%';

-- Delete Metadata
DELETE FROM wp_postmeta WHERE meta_key IN ('_twebsec_2fa_enabled', 'twebsec_last_activity', '_twebsec_2fa_emergency_codes', '_twebsec_2fa_secret', 'twebsec_cached_caps_old');
DELETE FROM wp_usermeta WHERE meta_key IN ('_twebsec_2fa_enabled', 'twebsec_last_activity', '_twebsec_2fa_emergency_codes', '_twebsec_2fa_secret', 'twebsec_cached_caps_old');
DELETE FROM wp_termmeta WHERE meta_key IN ('_twebsec_2fa_enabled', 'twebsec_last_activity', '_twebsec_2fa_emergency_codes', '_twebsec_2fa_secret', 'twebsec_cached_caps_old');
DELETE FROM wp_commentmeta WHERE meta_key IN ('_twebsec_2fa_enabled', 'twebsec_last_activity', '_twebsec_2fa_emergency_codes', '_twebsec_2fa_secret', 'twebsec_cached_caps_old');

