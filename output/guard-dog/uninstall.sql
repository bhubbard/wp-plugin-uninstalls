-- WordPress Plugin Uninstall SQL Script

-- Delete Options & Transients
DELETE FROM wp_options WHERE option_name IN ('guard_dog_captcha_use_enterprise', 'guard_dog_debug_enabled', 'guard_dog_debug_level', 'guard_dog_sessions_enabled', 'guard_dog_sessions_max_per_user', 'guard_dog_sessions_timeout_minutes', 'guard_dog_sessions_detect_ip_shift', 'guard_dog_sessions_detect_geo_anomaly', 'guard_dog_sessions_notify_user', 'guard_dog_ip_reputation_login_enabled', 'guard_dog_ip_reputation_login_threshold', 'guard_dog_ip_reputation_session_enabled', 'guard_dog_ip_reputation_session_threshold', 'guard_dog_ipinfo_token', 'guard_dog_ip_reputation_disable_geo', 'guard_dog_ip_detection_method', 'guard_dog_trusted_proxy_ips', 'guard_dog_site_wide_blocking', 'guard_dog_ip_blacklist', 'guard_dog_ip_whitelist', 'guard_dog_user_blacklist', 'guard_dog_user_whitelist', 'guard_dog_country_blacklist', 'guard_dog_log_retention_days', 'guard_dog_max_log_entries', 'guard_dog_log_ip_addresses', 'guard_dog_log_user_agents', 'guard_dog_activity_log_settings', 'guard_dog_captcha_provider', 'guard_dog_recaptcha_v2_theme', 'guard_dog_recaptcha_v2_size', 'guard_dog_recaptcha_v3_threshold', 'guard_dog_login_slug', 'guard_dog_lla_enabled', 'guard_dog_lla_max_retries', 'guard_dog_lla_lockout_duration', 'guard_dog_two_factor_enabled', 'guard_dog_two_factor_enforced', 'guard_dog_two_factor_grace_period', 'guard_dog_two_factor_enforcement_date', 'guard_dog_email_2fa_enabled', 'guard_dog_passkeys_enabled', 'guard_dog_passkeys_bypass_2fa', 'guard_dog_passkeys_require_user_verification', 'guard_dog_email_provider_settings', 'guard_dog_email_provider', 'guard_dog_enum_enabled', 'guard_dog_enum_bypass_roles', 'guard_dog_enum_auto_block_enabled', 'guard_dog_enum_auto_block_threshold');
DELETE FROM wp_options WHERE option_name IN ('guard_dog_enum_auto_block_window', 'guard_dog_enum_auto_block_duration', 'guard_dog_enum_alert_immediate_enabled', 'guard_dog_enum_alert_immediate_threshold', 'guard_dog_enum_alert_immediate_window', 'guard_dog_enum_alert_immediate_email', 'guard_dog_enum_alert_immediate_cooldown', 'guard_dog_enum_alert_digest_enabled', 'guard_dog_enum_alert_digest_frequency', 'guard_dog_enum_alert_digest_threshold', 'guard_dog_enum_alert_digest_email', 'guard_dog_social_login_enabled', 'guard_dog_social_google_enabled', 'guard_dog_social_google_client_id', 'guard_dog_social_google_client_secret', 'guard_dog_social_microsoft_enabled', 'guard_dog_social_microsoft_client_id', 'guard_dog_social_microsoft_client_secret', 'guard_dog_social_apple_enabled', 'guard_dog_social_apple_client_id', 'guard_dog_social_apple_team_id', 'guard_dog_social_apple_key_id', 'guard_dog_social_apple_key_file', 'guard_dog_social_auto_link_email', 'guard_dog_social_auto_create_users', 'guard_dog_social_new_user_role', 'guard_dog_social_bypass_2fa', 'guard_dog_enum_rest_api_block', 'guard_dog_enum_author_archives_block', 'guard_dog_enum_login_errors_block', 'guard_dog_enum_password_reset_block', 'guard_dog_enum_xmlrpc_block', 'guard_dog_enum_oembed_block', 'guard_dog_enum_registration_block', 'guard_dog_email_provider_global_override', 'guard_dog_login_attempts_enabled', 'guard_dog_temp_access_default_role', 'guard_dog_temp_access_default_expiry', 'guard_dog_temp_access_max_logins', 'guard_dog_password_min_length', 'guard_dog_password_require_uppercase', 'guard_dog_password_require_lowercase', 'guard_dog_password_require_numbers', 'guard_dog_password_require_special', 'guard_dog_password_block_common', 'guard_dog_password_block_username', 'guard_dog_password_block_email', 'guard_dog_password_reuse_limit', 'guard_dog_password_policy_exempt_roles', 'guard_dog_password_expiration_enabled');
DELETE FROM wp_options WHERE option_name IN ('guard_dog_password_expiration_days', 'guard_dog_password_expiration_warning_days', 'guard_dog_password_expiration_email_enabled', 'guard_dog_password_expiration_exempt_roles', 'guard_dog_logged_event_types', 'guard_dog_temp_access_tokens', 'guard_dog_generic_login_error', 'guard_dog_access_mode', 'guard_dog_access_denied_message', 'guard_dog_wp_version_before_update', 'guard_dog_captcha_error_message', 'guard_dog_health_report');
DELETE FROM wp_options WHERE option_name LIKE '%_site_key';
DELETE FROM wp_options WHERE option_name LIKE '%_secret_key';
DELETE FROM wp_options WHERE option_name LIKE 'guard_dog_last_email_test_%';
DELETE FROM wp_options WHERE option_name LIKE 'guard_dog_password_reset_pending_%';
DELETE FROM wp_options WHERE option_name LIKE 'guard_dog_password_reset_success_%';
DELETE FROM wp_options WHERE option_name LIKE '_guard_dog_show_recovery_codes_%';
DELETE FROM wp_options WHERE option_name LIKE 'guard_dog_2fa_grace_warning_%';
DELETE FROM wp_options WHERE option_name LIKE 'guard_dog_2fa_config_error_%';
DELETE FROM wp_options WHERE option_name LIKE 'guard_dog_show_recovery_codes_%';
DELETE FROM wp_options WHERE option_name LIKE 'guard_dog_login_state_%';

-- Delete Metadata
DELETE FROM wp_postmeta WHERE meta_key IN ('session_tokens', 'guard_dog_social_avatar_url', 'show_welcome_panel', '_guard_dog_2fa_temp_secret', '_guard_dog_2fa_enabled', '_guard_dog_2fa_secret', '_guard_dog_2fa_backup_codes');
DELETE FROM wp_usermeta WHERE meta_key IN ('session_tokens', 'guard_dog_social_avatar_url', 'show_welcome_panel', '_guard_dog_2fa_temp_secret', '_guard_dog_2fa_enabled', '_guard_dog_2fa_secret', '_guard_dog_2fa_backup_codes');
DELETE FROM wp_termmeta WHERE meta_key IN ('session_tokens', 'guard_dog_social_avatar_url', 'show_welcome_panel', '_guard_dog_2fa_temp_secret', '_guard_dog_2fa_enabled', '_guard_dog_2fa_secret', '_guard_dog_2fa_backup_codes');
DELETE FROM wp_commentmeta WHERE meta_key IN ('session_tokens', 'guard_dog_social_avatar_url', 'show_welcome_panel', '_guard_dog_2fa_temp_secret', '_guard_dog_2fa_enabled', '_guard_dog_2fa_secret', '_guard_dog_2fa_backup_codes');

